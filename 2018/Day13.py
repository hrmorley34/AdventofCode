grid = r"""            /-------------------------------------------------------------------------------------\               /-------------------------------\   
  /---------+---\                                                                   /-------------+---------------+---\              /-----------\|   
  |       /-+---+-----------------------------------------------\                 /-+-------------+---------------+---+----\         |           ||   
  |       | |   |                /----------\      /------------+------------\    | |/------------+---------------+---+----+---------+------\    ||   
 /+-------+-+---+----------------+----------+--\   |  /---------+------------+----+-++------------+---------------+---+----+---------+--\   |    ||   
 ||       | |   |                |          |  |   |  |         |           /+----+-++------------+---------------+---+----+---------+--+---+\   ||   
 ||       | |   | /--------------+----------+--+---+--+---------+-----------++----+\||            |         /-----+---+----+---\     |  |   ||   ||   
 ||       | |/--+-+------\       |          |  | /-+--+---------+-----------++----++++------------+---------+-----+---+----+---+-----+--+---++---++\  
 ||       | ||  | |      |       |   /------+--+-+-+--+---------+-----------++----++++------------+------\  |     |   |    |   |     |  |   ||   |||  
 ||       | ||  | |      |       |/--+-----\|  | | |  |         |           ||    ||||            |      |  |     |   |    |   |     |  |   ||   |||  
 ||       | ||  | |      |       ||  |     ||  | | |  |         |           ||    ||||            |      |  |     |   | /--+---+-----+--+---++---+++\ 
 ||       | ||  | |      |       ||  |     ||  | |/+--+---------+-----------++----++++------------+------+--+-----+---+-+--+---+-----+--+---++-\ |||| 
 ||   /---+-++--+-+------+-------++--+-----++--+-+++--+---------+---\       ||    ||||            |      |  |     |   | |  |   |     \--+---++-+-/||| 
 ||   |   \-++--+-+------+-------++--+-----++--+-+++--+---------/   |       ||    ||||            |      |  |     |   | |  |   |        |   || |  ||| 
 ||  /+-----++--+-+------+-------++--+-----++--+-+++--+-------------+-------++----++++-----------\|      |  |     |   | |  |   |        |   || |  ||| 
 ||  ||     ||  | |      |   /---++--+-----++--+-+++--+-------------+-------++----++++-----------++-----\|  |     |   | |  | /-+-------\|   || |  ||| 
 ||  ||     ||  | |   /--+---+---++--+-----++--+-+++--+-------------+-------++----++++-----------++-----++--+-----+\  | |  | | |       ||   || |  ||| 
 ||  || /---++--+-+---+--+---+---++--+-----++--+-+++--+-------------+-------++--\ ||||           ||     ||  |     ||  | |  | | |       ||   || |  ||| 
 ||  || |/--++--+-+---+--+---+---++--+-----++--+-+++-\|    /--------+-------++--+-++++-----------++->---++--+-----++--+-+--+-+-+---\   ||   || |  ||| 
 ||  || ||  ||  | |   |  |   |   \+--+-----+/  | ||| ||    |        |       ||  | ||||       /---++-----++--+-----++--+-+--+-+\|   |   ||   || |  ||| 
 \+--++-++--++--+-+---+--+---+----+--+-----+---/ ||| ||    |        |       ||/-+-++++-------+---++-----++--+-----++--+-+--+-+++---+-\ ||   || |  ||| 
  | /++-++--++--+-+---+--+---+----+--+-----+-----+++-++----+-------\|       ||| | ||||       |   ||     ||  |     ||  | |  | |||   | | ||   || |  ||| 
/-+-+++-++--++--+-+---+--+---+----+--+-----+-----+++-++----+-------++-------+++-+-++++------\|   ||     ||  |     ||  | \--+-+++---+-+-++---++-+--++/ 
| | ||| ||  |\--+-+---+--/   |  /-+--+---\ |     ||| ||    |       ||      /+++-+-++++------++---++-----++--+-----++--+---\| |||   | | ||   || |  ||  
| | ||| ||  |   | |   |     /+--+-+--+---+-+-----+++-++----+--\  /-++------++++-+-++++------++---++-----++--+-----++--+---++-+++---+>+-++--\|| |  ||  
| | ||| || /+---+-+---+-----++--+-+--+---+-+-----+++-++----+--+--+-++---->-++++-+-++++---\  ||   ||     ||  |     ||  |   || |||   | | ||  ||| |  ||  
| | ||| || ||   | |   |     ||  | |  |   | |   /-+++-++----+--+--+-++------++++-+-++++---+--++---++-----++--+-----++--+---++-+++\  | | ||  ||| |  ||  
| | ||| || ||   | |   |     ||  | |  |   | |   | ||| ||    |  |  | ||      |||| | ||||   |  ||   ||     ||  |     ||  |   || ||||  | | ||  ||| |  ||  
|/+-+++-++-++---+-+---+-----++--+-+--+---+-+---+-+++-++----+--+--+-++-\    |||| | ||||   |  ||   ||     ||  |     ||  |   || ||||  | | ||  ||| |  ||  
||| ||| || ||   |/+---+-----++--+-+--+---+-+---+-+++-++----+--+--+-++-+----++++-+-++++---+--++---++-----++--+-----++--+-\ || ||||  | | ||  ||| |  ||  
||| ||| || || /-+++---+-----++--+-+-\|   | |  /+-+++-++----+--+--+-++-+----++++-+-++++---+--++---++-----++--+-----++--+\| || ||||  | | ||  ||| |  ||  
||| ||| || || | |||   \-----++--+-+-++---+-+--++-+++-++----+--+--+-++-+----++++-+-++++---+--++---++-----++--+-----+/  ||| || ||||  | | ||  ||| |  ||  
||| ||| || || | |||         ||  | \-++---+-/  || ||\-++----+--+--+-++-+----++/| | |||| /-+--++---++-----++--+-----+---+++-++-++++--+-+-++--+++-+--++-\
||| ||| || || | |||         ||  |/--++---+----++-++--++----+--+--+-++-+----++-+-+\|||| | |  ||   ||     ||  |     |   ||| || ||||  | | ||  ||| |  || |
||| ||| ||/++-+-+++---------++-\||  ||   |    || ||/-++----+--+--+-++-+----++-+-++++++-+-+--++---++-----++--+-----+---+++-++-++++--+-+-++--+++\|  || |
||| ||| ||||| | |||         || |||  ||   |    || ||| ||    |  |  | || |    \+-+-++++++-+-+--++---++-----++--+-----+---+++-/| ||||  | | ||  |||||  || |
||| ||| ||||| | |||       /-++-+++--++---+----++-+++-++----+--+--+-++-+-----+-+-++++++-+-+--++---++-----++--+-----+---+++--+-++++--+-+\||  |||||  || |
||| ||| ||||| | |||       | || |||  ||/--+----++-+++-++----+--+--+-++-+-----+-+-++++++-+-+--++---++-----++--+-----+---+++--+-++++--+-++++\ |||||  || |
||| ||| ||||| | |||       | || |||  |||  |    |\-+++-++----+--+--+-++-+-----+-+-++++++-+-+--++---++-----++--+-----+---+++--+-+++/  | ||||| |||||  || |
||| ||| ||||| | |||       | |\-+++--+++--+----+--+++-++----+--+--+-++-+-----+-+-++++++-+-+--++---++-----/|  |     |   |||  | |||   | ||||| |||||  || |
|||/+++-+++++-+-+++-----\ | |  |||  ||| /+----+--+++-++----+--+--+-++-+-----+-+-++++++-+-+--++---++------+--+-\   |   |||  | |||   | ||||| |||||  || |
||||||| ||||| | |||  /--+-+-+--+++--+++-++----+--+++-++----+--+--+-++-+-----+-+-++++++-+-+--++---++------+--+-+---+---+++--+-+++-\ | ||||| |||||  || |
||||||| ||||| | |||  |  | | |  |||  ||| ||    |  ||| ||  /-+--+--+-++-+-----+-+-++++++-+-+--++---++------+--+-+\  |   |||  | ||| | | ||||| |||||  || |
||||||| \++++-+-+++--+--+-+-+--+++--+++-++----+--+++-++--+-+--+--+-++-+-----+-+-/||||| v |  ||/--++------+--+-++--+---+++--+-+++-+-+-+++++\|||||  || |
|||||||  |||| | |||  |  | | |  |||  ||| ||    |  ||| ||  | |  |  | || |     | |  ||||| | |  |||  ||      |  | ||  |   |||  | \++-+-+-++/||||||||  || |
|||||||  |||| | |||  |  | | |  |||  ||| ||    |  ||| ||  | |  |  | || |     | |  ||||| | |  |||  ||      |  | ||  |   |||  |  || | | || ||||||||  || |
|||||||  |||| | |||  |  | | |  |||  ||| ||    |  ||| ||  | |  |  | || |     | |/-+++++-+-+--+++--++------+--+-++--+---+++--+--++-+-+-++\||||||||  || |
|||||||  |||| | |||  |  | | |  |||  ||| ||    |  |||/++--+-+--+--+-++-+-----+-++-+++++-+-+--+++--++------+--+-++--+---+++--+\ || | | |||||||||||  || |
|||||||  |||| | |||/-+--+-+-+--+++--+++-++----+--++++++--+-+--+--+-++-+-----+-++-+++++-+-+--+++--++------+--+-++--+---+++--++\|| | | ||||||||^||  || |
|||||||  |||| | |||| |  | | |  |||  ||| ||    |  ||||||  | |  |  | || |     | || ||||| | |  |||  ||      |  | ||  |   |||  ||||| | | |||||||||||  || |
|||||||  |||| | |||| |  | | |  ||| /+++-++----+--++++++--+-+--+--+-++-+-----+-++-+++++-+-+--+++--++------+--+-++--+\  |||  ||||| | | |||||||||||  || |
|||||||  |||| | |||| |  | | |  ||| |||| ||   /+--++++++--+-+--+--+-++-+-----+-++-+++++-+-+--+++--++-----\|  | ||  ||  ||| /+++++-+-+\|||||||||||  || |
|||||||  |||| | |||| |  | | |  ||| |||| ||   ||  ||||||  | |  |  | || |     | || ||||| | |  ||\--++-----++--+-++--++--+++-++++++-+-+++++++/|||||  || |
|||||||  |||| | |||| |  | | |  ||| |||| ||   ||  ||||||  | |  |  | || |     | || ||||| | |  ||   ||     ||  | ||  ||  ||| |||||| | ||||||| |||||  || |
|||||||  |||| | |||| |  | | |  ||| |||| ||   ||  ||||||  | \--+--+-++-+-----+-++-+++++-+-+--++---++-----++--+-++--++--+++-++++++-+-/|||||| |||||  || |
|||||||/-++++-+-++++-+--+-+-+--+++-++++-++---++-\||||||  |    |  | || |     | || ||||| | |  ||   ||     ||  | ||  ||  ||| |||||| |  |||||| |||||  || |
|||||||| |||| | |||| |  | | |  ||| ||\+-++---++-+++++++--+----+--+-++-+-----+-++-+++++-+-+--++---++-----+/  | ||  ||  ||| |||||| |  |||||| |||||  || |
|||||||| |||| | |||| |  | | \--+++-++-+-++---++-+++++++--+----/  | || |     | || |\+++-+-+--++---++-----+---+-++--++--+++-+/|||| |  |||||| |||||  || |
|||||||| |||| | |||| |  | |    |||/++-+-++---++-+++++++--+-------+-++-+-----+-++-+-+++-+-+--++---++\    |   | ||  ||  ||| | |||| |  |||||| |||||  || |
|||||||| |||| | |||| |  | |    |||||| | ||   || |||||||  | /-----+-++\|     | || | ||| | |  ||   |||    |   | ||  ||  ||| | |||| |  ^||||| |||||  || |
|||||||| |||| | |||| |  | |    |||||| | ||   \+-+++++++--+-+-----+-++++-----+-++-+-+++-+-+--++---+++----/   | ||  ||  ||| | |||| |  |||||| |||||  || |
|||||||| |||| | |||| |  | |  /-++++++-+-++----+-+++++++--+-+-----+-++++-----+\|| | ||| | |  |\---+++--------+-++--++--+++-+-++/| |  |||||| |||||  || |
|||||||| |||| | |||| |  | |  | |||||| | ||    | |||||||  | |     | ||||     |||| | ||| | |  |    |||        | ||  ^|  ||| | || | |  |||||| |||||  || |
|||||||| |||| | |||| |  | \--+-++++++-+-++----+-+++++++--+-+-----+-++++-----++++-+-+++-+-+--+----+++--------+-++--++--+++-+-++-+-+--++/||| |||||  || |
|||||||| |||| | |||| |  |    |/++++++-+-++----+-+++++++--+-+-----+-++++-----++++-+-+++-+-+--+----+++--------+-++--++--+++-+-++-+-+--++-+++\|||||  || |
||||||||/++++-+-++++-+--+----++++++++-+-++----+-+++++++--+-+-----+-++++-----++++-+-+++-+-+--+----+++--------+-++\/++--+++-+-++-+-+--++-+++++++++-\|| |
||||||||||||| | |||| |/-+----++++++++-+-++----+-+++++++--+-+-----+-++++-----++++-+-+++-+-+--+----+++--------+-++++++--+++-+-++-+-+\ || ||||||||| ||| |
|||||||\+++++-+-++++-++-+----++++++++-+-++----+-/||||||  | |     | ||||   /-++++-+-+++-+-+\ |    |||        | ||||||  ||| | || | || || ||||||||| ||| |
|||||||/+++++-+-++++-++-+----++++++++-+-++----+--++++++--+-+-----+-++++--\| |||| | ||| | || |    |||        | ||||||  ||| | || | || || ||||||||| ||| |
||||||||||||| | |||| || |    ||||||\+-+-++----+--++++++--+-+-----+-++++--++-++++-+-+++-+-++-+----+++--------+-+++++/  ||| | || | || || ||||||||| ||| |
|||||||||||||/+-++++-++-+----++++++-+-+-++----+--++++++--+-+-----+-++++--++-++++-+-+++-+-++\|    |||        | |||||   ||| | || | || || ||||||||| ||| |
||||||||||||||| |||| || |    |||||| | | ||    |  ||||||  | |     |/++++--++-++++-+-+++-+-++++----+++\   /---+-+++++---+++-+-++-+\|| || ||||||||| ||| |
||||||||||||||| |||| || |    ||||\+-+-+-++----+--++++++--+-+-----++++++--++-++++-/ ||| | ||||    ||||   |   | |||||   ||| | || |||| || ||||||||| ||| |
||||||||||||||| |||| ||/+--<-++++-+-+-+-++----+--++++++--+-+-----++++++--++-++++--\||| | ||||    ||||   |   | |||||   ||| | || |||| || ||||||||| ||| |
||\++++++++++++-/||| ||||    \+++-+-+-+-++----+--++++++--+-+-----++++++--++-+/||/-++++-+-++++----++++---+---+-+++++---+++-+-++-++++-++-+++++++++\||| |
|| ||||||||||||  |||/++++-----+++-+-+-+-++----+--++++++--+-+-----++++++--++-+-+++-++++-+-++++----++++---+---+-+++++-\ ||| | || |||| || ||||||||||||| |
|\-++++++++++++--++++++++-----+++-+-+-+-++----+--++++++--+-+-----+++++/  || | ||| |||| | ||||    ||||   |   \-+++++-+-+++-+-++-/||| || ||||||||||||| |
|/-++++++++++++--++++++++-----+++-+-+-+-++----+--++++++--+-+-----+++++---++-+-+++-++++-+-++++----++++---+----\||||| | ||| | ||  ||| || ||||||||||||| |
|| ||||||||||||  \+++++++-----+++-+-+-+-++----+--++++++--+-+-----+++++---++-+-+++-++++-+-++++----++++---+----++++++-+-++/ | ||  ||| || ||||||||||||| |
|| |||||||||\++---+++++++-----+++-+-+-+-++----+--++++++--+-+-----+++++---++-+-+++-++++-+-++++----+/||   |    |||||| | ||  | ||  ||| || ||||||||||||| |
|| ||||||||| ||  /+++++++-----+++-+-+\| ||    |  ||||||  | |     |||||   || | ||| |||| | ||||    | ||   |    ^||||| | ||  | ||  ||| || ||||||||||||| |
|| ||||||||| ||  ||||||||     ||| \-+++-++----+--++++++--+-+-----+++++---++-+-+++-++++-+-++++----+-/|   |    |||||| | ||  | ||  ||| || ||||||||||||| |
|| ||||||||| ||  ||||||||     ||\---+++-+/    |  ||||||  | |     |||||   || | |||/++++-+-++++----+--+---+----++++++-+-++--+-++--+++-++\||||||||||||| |
|| ||||||||| ||  ||||||||     ||    ||| |     |  |||||\--+-+-----+++++---++-+-++++++++-+-++++----+--+---+----++++++-+-++--+-++--+++-++++/||||||||||| |
|| ||||||||| ||  ||||||||     ||    ||| |/----+--+++++---+-+-----+++++-\ || | |||||||| | ||||    |  |   |    |||||| | ||  | ||  ||| |||| ||||||||||| |
|| ||||||||| |v  ||||||\+-----++----+++-++----+--+++++---+-+-----+++++-+-++-+-++++/||| |/++++----+--+---+----++++++-+-++--+-++-\||| |||| ||||||||||| |
|| |||\+++++-++--++++++-+-----++----+++-++----+--+++++---+-+-----+++/| | || | |||| ||| ||||||    |  |   |    |||||| | ||  | || |||| |||| ||||||||||| |
|| ||| ||||| ||  |||||| |     ||    ||| ||    |  |||||   | |     ||| | | || | |\++-+++-++++++----+--+---+----++++++-+-++--+-++-++++-+++/ ||||||||||| |
|| ||| ||||| ||  |||||| |     ||    ||| ||    |  |||||   | |     ||| | | || | | || ||| ||||||    |  |   |    |||||| | ||  | || |||| |||  ||||||||||| |
|| ||| ||||| ||  |||||| | /---++----+++-++---\|  |||||   | |     ||| | | || | | || ||\>++++++----+--+---+----++++++-+-++--+-++-++++-+++--+++/||||||| |
|| ||| ||||| ||  |||||| | |   ||    ||| ||   ||  |||||   | |     ||| | | || | | || |\-<++++++----+--+---+----++++++-+-/|  | || |||| |||  ||| ||||||| |
|| ||| ||||| ||  |||||| | |   ||    ||| ||   ||  |||||   | |     ||| | | || | | \+-+---++++++----+--+---+----++++++-+--+--+-++-++++-+++--+++-+++/||| |
||/+++-+++++-++--++++++-+-+---++-\  ||| ||   ||  |||\+---+-+-----+++-+-+-++-+-+--+-+---++++++----+--+---+----++++++-+>-+--+-/| |||| |||  ||| ||| ||| |
|\++++-+++++-++--++++++-+-+---++-+--+++-++---++--+++-+---+-+-----+++-+-+-++-+-+--+-+---++++++----+--+---+----/||||| |  |  |  | |||| |||  ||| ||| ||| |
| |||| ||||| ||  |\++++-+-+---++-+--+++-++---++--+++-+---+-+-----+++-+-+-++-+-+--+-/   ||||||    |  |  /+-----+++++-+--+--+--+-++++-+++\ ||| ||| ||| |
| |||| ||||| ||/-+-++++-+-+---++\|  ||| ||   ||  ||| |   | |     ||| | | || | |  |     ||||||    |  |  ||     ||||| |  |/-+--+-++++-++++-+++-+++-+++\|
| |||| ||||| ||| | |||| | |   ||||/-+++-++---++--+++-+---+-+----\\++-+-+-++-+-+--+-----++++++----+--+--++-----+++++-+--++-+--+-++++-++++-++/ ||| |||||
| |||| ||||| ||| | |||| | |   ||||| ||| ||   ||  \++-+---+-+----+-++-+-+-++-+-+--+-----++++++----+--+--++-----+++++-+--++-+--+-++++-++++-++--+++-++/||
| |||| ||||| ||| | |||\-+-+---+++++-+++-++---++---++-+---+-+----+-++-+-+-++-+-+--+-----++++++----+--+--++-----+++++-+--++-+--+-+++/ |||| ||  ||| || ||
| ||\+-+++++-+++-+-+++--+-+---+++++-+++-++---++---++-+---+-+----+-+/ | | ||/+-+--+-----++++++----+--+--++-----+++++-+-\|| |  | |||  |||| ||  ||| || ||
| || | ||||| ||| | |||  | |/--+++++-+++-++---++---++-+---+-+--\ | |  | | |||| |  |     ||||||   /+--+--++-----+++++-+-+++-+--+-+++--++++-++--+++-++\||
| || | ||||| ||| | |||  | ||  ||||| ||| ||   ||   || | /-+-+--+-+-+--+-+-++++-+--+-----++++++---++--+--++-----+++++-+-+++-+\ | |||  |||| ||  ||| |||||
| || | |||||/+++-+-+++--+-++--+++++-+++-++---++---++-+-+-+-+--+-+-+--+-+-++++-+--+-----++++++---++--+--++-\   ||||| | ^|| || |/+++--++++-++-\||| |||||
| || | ||||||||| | |||  | ||  ||||| ||\-++---++---++-+-+-+-+--+-+-+--+-+-++++-+--+-----++++++---++--+--++-+---+++++-+-+++-++-+++++--++++-/| |||| |||||
| || | ||||||||| \-+++--+-++--+++++-+/  ||   ||   || | | | |  | | |  | | |||\-+--+-----++++++---++--+--++-+---+++++-+-+++-++-+++++--++++--+-+/|| |||||
| || | \++++++++---+++--+-++--+++++-+---++---++---++-+-+-+-+--+-+-+--+-+-/||  |  |     ||||||   ||  |  || |   ||||| | ||| || |||||  ||||  | | || |||||
| || |  ||||||||   |||  | ||  ||||| |   ||   ||   || | | | |  | | |  | |  ||  |  |     ||||||   ||  |  || |   ||||| | ||| || |||||  ||||  | | || |||||
\-++-+--++++++++---+++--+-++--+++++-+---++---++---++-+-+-+-+--+-+-+--+-+--++--+--+-----+++++/   ||  |  || |   ||||\-+-+++-++-+++++--++++--+-+-++-+/|||
  || |  ||||||||   |||  | ||  ||||| |   ||   ||   || | | | |  | | |  | |  ||  |  |     |\+++----++--+--++-+---++++--+-+++-++-++/|v  ||||  | | || | |||
  || |  ||||||||   |||  | ||  ||||| |   ||   ||   |\-+-+-+-+--+-+-+--+-+--++--+--+-----+-+++----++--+--++-+---++++--+-+++-++-++-++--++++--+-+-/| | |||
  || |  ||||||||   |||  | ||  ||||| |   \+---++---+--+-+-+-+--+-+-+--+-+--++--+--+-----+-+++----++--+--++-+---/|||  | ||| || || ||  ||||  | |  | | |||
  || |  ||||\+++---+++--+-++--+++++-+----+---++---+--+-+-+-+--+-+-+--+-+--++--+--+-----+-+++----++--+--++-/    |||  | ||| || || ||  ||||  | |  | | |||
  || |  |||| |||   ||\--+-++--+++++-+----+--<++---+--+-+-+-+--+-+-+--+-+--++--+--+-----+-+++----++--+--++------+++--+-+++-++-++-+/  ||||  | |  | | |||
  || |  |||\-+++---++---+-++--+++++-+----+---++---+--+-+-+-+--+-+-+--+-+--++--+--+-----+-/||    \+--+--++------+++--+-+++-++-++-+---++++--+-+--+-+-/||
  || |  |||  |||   ||   | ||  ||||| |    |   ||   |  | | | |  | | |  | |  ||  |  |     |  ||     |  |  ||      |||  | ||| || |\-+---++++--+-/  | |  ||
  || |  |||  |||   ||   | ||  \++++-+----+---++---+--+-+-+-+--+-+-+--+-+--++--+--+-----+--++-----+--+--++------+++--+-+++-++-+--+---++++--/    | |  ||
  |\-+--+++--+++---++---/ ||   |||| |    |   ||   |  | |/+-+--+-+-+--+-+--++--+--+-----+\ ||     |  |  ||      |||  | ||| || |  |   ||||       | |  ||
  |  |  |||  |||   ||     ||   |||| |    |   ||   \--+-+++-+--+-+-+--+-+--++--+--+-----++-++-----+--+--++------+++--+-+++-++-+--+---++++-------/ |  ||
  |  |  |||  |||   ||     ||   |||| |    |/--++------+-+++-+--+-+-+--+>+--++--+--+-----++-++-----+--+--++------+++--+-+++-++-+--+--\||||         |  ||
  |/-+--+++--+++---++-----++---++++-+----++--++\     | ||| |  | | |  | |  ||  |  |     || ||     |  |  \+------+++--+-+++-++-+--+--++++/         |  ||
  || \--+++--+++---++-----++---++++-+----++--+++-----+-+++-+--+-+-+--+-+--++--+--+-----++-++-----/  |   |      |||  | ||| || |  |  ||||          |  ||
  ||  /-+++--+++---++-----++---++++-+----++--+++-----+-+++-+--+-+-+--+-+--++--+--+---\ || ||        |   |      ||\--+-+++-++-+--+--++++----------/  ||
  ||  | |||  |||   ||     ||   |||| |/---++--+++-----+-+++-+--+-+-+--+-+--++--+--+---+-++-++--------+---+------++---+-+++-++-+--+-\||||             ||
  ||  | |\+--+++---++-----++---++++-++---++--+++-----/ ||| |  | | |  | |  ||  |  |   | || ||        |   |      ||   | ||| || |  | |||||             ||
  ||  | | |  |||   ||     ||   |||\-++---++--+++-------+++-+--+-/ |  | |  ||  |  \---+-++-++--------+---+------++---+-+++-++-+--+-++++/             ||
  ||  | | |  |||   ||     \+---+++--++---++--/||       ||\-+--+---+--+-+--++--+------+-++-++--------+---+------/|   | ||| || |  | ||||              ||
  ||  | | |  |||   ||      |   |||  ||   ||   ||       ||  |  |   |  | |  ||  |      | \+-++--------+---+-------+---+-+++-++-+--+-++++--------------+/
  ||  | | |  |||   ||      |   |||  ||   ||   ||       ||  |  |   |  | |  ||  |      |  | ||       /+---+-------+---+-+++\|| |  | ||||              | 
  ||  | | |  ||\---++------+---+/|  ||   ||   ||       ||  |  |   |  | |  ||  \------+--+-++-------++---+-------+---+-++++++-+--+-+++/              | 
  ||  | | |  ||    ||     /+---+-+--++---++---++-------++--+--+---+--+-+--++---------+--+-++-------++---+--\    |   | |||||| |  | |||               | 
  ||  | | |  ||    \+-----++---+-+--++---++---++-------++--+--+---+--+-+--++---------+--+-++-------++---+--+----+---+-++++++-/  | |||               | 
  ||  | | |  ||     |     ||   | |  ||   ||   ||       |\--+--+---+--+-+--++---------+--/ ||       ||   |  |    |   | ||||||    | |||               | 
 /++--+-+-+--++-----+-----++---+-+--++---++---++-------+--\|  |   |  | |  ||         |    ||       ||   |  |    |   | ||||||    | |||               | 
 |||  | | |  |\-----+-----++---+-+--/|   ||   ||       |  ||  |   |  | |  \+---------+----/|       ||   |  |    |   | ||||||    | |||               | 
 |||  | | |  |      |     ||   | |   |   |\---++-------+--++--+---+--+-+---+---------+-----+-------++---+--+----+---+-++++++----+-+/|               | 
 |||  | | |  |      |     ||   | |   |   |    \+-------+--++--+---+--+-+---+---------+-----+-------++---+--+----+---+-+/||||    | | |               | 
 |\+--+-+-+--+------+-----++---+-/   \---+-----+-------+--++--+---+--+-+---+---------+-----+-------++---+--+----+---+-+-++++----+-/ |               | 
 | |  | | \--+------+-----++---/         |     |       |  ||  |   \--+-+---+---------+-----+-------+/   |  |    |   | | ||||    |   |               | 
 | |  | |    |      \-----++-------------+-----+-------+--++--+------+-+---+---------+-----+-------+----+--+----+---/ | ||||    |   |               | 
 | |  | |    |            ||             |     |       \--++--+------+-+---+---------+-----+-------+----+--+----+-----+-+++/    |   |               | 
 | |  | |    |            ||             |     |          |\--+------/ |   |         |     |       |    |  |    |     | |||     |   |               | 
 | |  \-+----+------------++-------------+-----+----------+---+--------+---+---------/     |       |    |  |    |     | |||     |   |               | 
 | |    |    \------------++-------------+-----+----------+---+--------+---+---------------/       |    |  |    |     | \++-----+---+---------------/ 
 | |    |                 ||             \-----+----------+---+--------/   \-----------------------+----+--+----+-----/  ||     |   |                 
 | |    |                 \+-------------------+----------+---+------------------------------------+----+--/    |        ||     |   |                 
 | \----+------------------+-------------------/          |   |                                    \----+-------+--------/\-----+---/                 
 |      |                  \------------------------------+---/                                         |       |               |                     
 |      \-------------------------------------------------+---------------------------------------------+-------/               |                     
 \--------------------------------------------------------/                                             \-----------------------/                     
                                                                                                                                                      """

grid = grid.splitlines()
dim = (max(map(len, grid)), len(grid))

def sort(cars):
    cars.sort(key=lambda c: c[0][1]*dim[0]+c[0][0])
def addturn(oldd, turna=None):
    #  2
    # 3+1
    #  0
    d = 0 # (0, 1)
    if oldd == (1, 0):
        d = 1
    elif oldd == (0, -1):
        d = 2
    elif oldd == (-1, 0):
        d = 3
    turns = [1,0,-1] # left,right,straight
    if turna is not None:
        d += turns[turna % len(turns)]
    outvels = [(0,1),(1,0),(0,-1),(-1,0)]
    arrows = "v>^<"
    return(outvels[d % 4], arrows[d % 4])

def update(grid, cars):
    grid = list(map(list, grid))
    newcars = []
    crash = []
    for [x,y], [xvel,yvel], replacechar, turndir in cars:
        arrow = grid[y][x]
        newx, newy = x + xvel, y + yvel
        newxvel, newyvel = xvel, yvel
        grid[y][x] = replacechar
        newchar = grid[newy][newx]
        if newchar in "<^>v":
            crash.append([newx, newy])
            arrow = "X"
        newturn = turndir
        if newchar == "+":
            [newxvel, newyvel], arrow = addturn((xvel,yvel), turndir)
            turndir += 1
        elif newchar == "/":
            newxvel, newyvel = -yvel, -xvel
            arrow = addturn((newxvel, newyvel))[1]
        elif newchar == "\\":
            newxvel, newyvel = yvel, xvel
            arrow = addturn((newxvel, newyvel))[1]
        grid[newy][newx] = arrow
        newcars.append([[newx,newy], [newxvel,newyvel], newchar, turndir])
    grid = list(map(lambda r: "".join(r), grid))
    return(grid, newcars, crash)

cars = []
for y in range(0, dim[1]):
    for x in range(0, dim[0]):
        if grid[y][x] == ">":
            cars.append([[x,y], [1,0], "-", 0])
        elif grid[y][x] == "^":
            cars.append([[x,y], [0,-1], "|", 0])
        elif grid[y][x] == "<":
            cars.append([[x,y], [-1,0], "-", 0])
        elif grid[y][x] == "v":
            cars.append([[x,y], [0,1], "|", 0])

time = 0
print(time)
print("\n".join(grid))
time += 1
while True:
    grid, cars, crash = update(grid, cars)
    print("\n".join(grid))
    if len(crash):
        print(str(time)+": "+", ".join(map(lambda c: "("+",".join(map(str, c))+")", crash)))
        to_fix = list(filter(lambda c: c[0] in crash, cars))
        cars = list(filter(lambda c: c[0] not in crash, cars))
        grid = list(map(list, grid))
        for c in to_fix:
            if c[2] not in "<^>v":
                grid[c[0][1]][c[0][0]] = c[2]
        grid = list(map(lambda r: "".join(r), grid))
    elif not time % 1000:
        print(time)
    if len(cars) == 1:
        print(str(time)+": "+",".join(map(str, cars[0][0])))
        break
    elif len(cars) == 0:
        break
    time += 1
